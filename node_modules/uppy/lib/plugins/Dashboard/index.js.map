{"version":3,"sources":["../../../src/plugins/Dashboard/index.js"],"names":["Plugin","require","Translator","dragDrop","Dashboard","StatusBar","Informer","findDOMElement","prettyBytes","defaultTabIcon","module","exports","core","opts","id","title","type","defaultLocale","strings","selectToUpload","closeModal","upload","importFrom","dashboardWindowTitle","dashboardTitle","copyLinkToClipboardSuccess","copyLinkToClipboardFallback","done","localDisk","myDevice","dropPasteImport","dropPaste","browse","fileProgress","numberOfSelectedFiles","uploadAllNewFiles","defaultOptions","target","getMetaFromForm","trigger","inline","width","height","semiTransparent","showProgressDetails","hideUploadButton","note","locale","translator","containerWidth","translate","bind","hideModal","showModal","addTarget","actions","hideAllPanels","showPanel","initEvents","handleEscapeKeyPress","handleFileCard","handleDrop","pauseAll","resumeAll","cancelAll","updateDashboardElWidth","render","install","plugin","callerPluginId","constructor","name","callerPluginName","callerPluginIcon","icon","callerPluginType","msg","log","focus","isHidden","modal","getState","newTargets","targets","slice","push","setState","activePanel","filter","document","body","classList","remove","window","scrollTo","savedDocumentScrollPosition","scrollY","add","style","top","querySelector","setTimeout","event","keyCode","showModalTrigger","addEventListener","removeDragDropListener","el","files","removeEvents","removeEventListener","on","removeActions","off","dashboardEl","offsetWidth","fileId","fileCardFor","forEach","file","addFile","source","data","emit","state","newFiles","Object","keys","progress","uploadStarted","inProgressFiles","uploadComplete","isPaused","inProgressFilesArray","totalSize","totalUploadedSize","bytesTotal","bytesUploaded","acquirers","progressindicators","removeFile","fileID","emitter","startUpload","ev","catch","err","console","error","stack","message","pauseUpload","cancelUpload","showFileCard","fileCardDone","meta","info","text","duration","resumableUploads","capabilities","totalFileCount","length","totalProgress","autoProceed","i18n","metaFields","maxWidth","maxHeight","currentWidth","isWide","mount","disableStatusBar","use","DashboardUI","disableInformer","uninstall","unmount"],"mappings":"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","file":"index.js","sourcesContent":["const Plugin = require('../Plugin')\nconst Translator = require('../../core/Translator')\nconst dragDrop = require('drag-drop')\nconst Dashboard = require('./Dashboard')\nconst StatusBar = require('../StatusBar')\nconst Informer = require('../Informer')\nconst { findDOMElement } = require('../../core/Utils')\nconst prettyBytes = require('prettier-bytes')\nconst { defaultTabIcon } = require('./icons')\n\n/**\n * Modal Dialog & Dashboard\n */\nmodule.exports = class DashboardUI extends Plugin {\n  constructor (core, opts) {\n    super(core, opts)\n    this.id = 'DashboardUI'\n    this.title = 'Dashboard UI'\n    this.type = 'orchestrator'\n\n    const defaultLocale = {\n      strings: {\n        selectToUpload: 'Select files to upload',\n        closeModal: 'Close Modal',\n        upload: 'Upload',\n        importFrom: 'Import files from',\n        dashboardWindowTitle: 'Uppy Dashboard Window (Press escape to close)',\n        dashboardTitle: 'Uppy Dashboard',\n        copyLinkToClipboardSuccess: 'Link copied to clipboard.',\n        copyLinkToClipboardFallback: 'Copy the URL below',\n        done: 'Done',\n        localDisk: 'Local Disk',\n        myDevice: 'My Device',\n        dropPasteImport: 'Drop files here, paste, import from one of the locations above or',\n        dropPaste: 'Drop files here, paste or',\n        browse: 'browse',\n        fileProgress: 'File progress: upload speed and ETA',\n        numberOfSelectedFiles: 'Number of selected files',\n        uploadAllNewFiles: 'Upload all new files'\n      }\n    }\n\n    // set default options\n    const defaultOptions = {\n      target: 'body',\n      getMetaFromForm: true,\n      trigger: '#uppy-select-files',\n      inline: false,\n      width: 750,\n      height: 550,\n      semiTransparent: false,\n      defaultTabIcon: defaultTabIcon(),\n      showProgressDetails: false,\n      hideUploadButton: false,\n      note: false,\n      locale: defaultLocale\n    }\n\n    // merge default options with the ones set by user\n    this.opts = Object.assign({}, defaultOptions, opts)\n\n    this.locale = Object.assign({}, defaultLocale, this.opts.locale)\n    this.locale.strings = Object.assign({}, defaultLocale.strings, this.opts.locale.strings)\n\n    this.translator = new Translator({locale: this.locale})\n    this.containerWidth = this.translator.translate.bind(this.translator)\n\n    this.hideModal = this.hideModal.bind(this)\n    this.showModal = this.showModal.bind(this)\n\n    this.addTarget = this.addTarget.bind(this)\n    this.actions = this.actions.bind(this)\n    this.hideAllPanels = this.hideAllPanels.bind(this)\n    this.showPanel = this.showPanel.bind(this)\n    this.initEvents = this.initEvents.bind(this)\n    this.handleEscapeKeyPress = this.handleEscapeKeyPress.bind(this)\n    this.handleFileCard = this.handleFileCard.bind(this)\n    this.handleDrop = this.handleDrop.bind(this)\n    this.pauseAll = this.pauseAll.bind(this)\n    this.resumeAll = this.resumeAll.bind(this)\n    this.cancelAll = this.cancelAll.bind(this)\n    this.updateDashboardElWidth = this.updateDashboardElWidth.bind(this)\n    this.render = this.render.bind(this)\n    this.install = this.install.bind(this)\n  }\n\n  addTarget (plugin) {\n    const callerPluginId = plugin.id || plugin.constructor.name\n    const callerPluginName = plugin.title || callerPluginId\n    const callerPluginIcon = plugin.icon || this.opts.defaultTabIcon\n    const callerPluginType = plugin.type\n\n    if (callerPluginType !== 'acquirer' &&\n        callerPluginType !== 'progressindicator' &&\n        callerPluginType !== 'presenter') {\n      let msg = 'Dashboard: Modal can only be used by plugins of types: acquirer, progressindicator, presenter'\n      this.core.log(msg)\n      return\n    }\n\n    const target = {\n      id: callerPluginId,\n      name: callerPluginName,\n      icon: callerPluginIcon,\n      type: callerPluginType,\n      focus: plugin.focus,\n      render: plugin.render,\n      isHidden: true\n    }\n\n    const modal = this.core.getState().modal\n    const newTargets = modal.targets.slice()\n    newTargets.push(target)\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        targets: newTargets\n      })\n    })\n\n    return this.target\n  }\n\n  hideAllPanels () {\n    const modal = this.core.getState().modal\n\n    this.core.setState({modal: Object.assign({}, modal, {\n      activePanel: false\n    })})\n  }\n\n  showPanel (id) {\n    const modal = this.core.getState().modal\n\n    const activePanel = modal.targets.filter((target) => {\n      return target.type === 'acquirer' && target.id === id\n    })[0]\n\n    this.core.setState({modal: Object.assign({}, modal, {\n      activePanel: activePanel\n    })})\n  }\n\n  hideModal () {\n    const modal = this.core.getState().modal\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        isHidden: true\n      })\n    })\n\n    document.body.classList.remove('is-UppyDashboard-open')\n\n    window.scrollTo(0, this.savedDocumentScrollPosition)\n  }\n\n  showModal () {\n    const modal = this.core.getState().modal\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        isHidden: false\n      })\n    })\n\n    // save scroll position\n    this.savedDocumentScrollPosition = window.scrollY\n\n    // add class to body that sets position fixed, move everything back\n    // to scroll position\n    document.body.classList.add('is-UppyDashboard-open')\n    document.body.style.top = `-${this.savedDocumentScrollPosition}px`\n\n    // focus on modal inner block\n    this.target.querySelector('.UppyDashboard-inner').focus()\n\n    // this.updateDashboardElWidth()\n    // to be sure, sometimes when the function runs, container size is still 0\n    setTimeout(this.updateDashboardElWidth, 500)\n  }\n\n  // Close the Modal on esc key press\n  handleEscapeKeyPress (event) {\n    if (event.keyCode === 27) {\n      this.hideModal()\n    }\n  }\n\n  initEvents () {\n    // Modal open button\n    const showModalTrigger = findDOMElement(this.opts.trigger)\n    if (!this.opts.inline && showModalTrigger) {\n      showModalTrigger.addEventListener('click', this.showModal)\n    }\n\n    if (!this.opts.inline && !showModalTrigger) {\n      this.core.log('Dashboard modal trigger not found, you won’t be able to select files. Make sure `trigger` is set correctly in Dashboard options', 'error')\n    }\n\n    document.body.addEventListener('keyup', this.handleEscapeKeyPress)\n\n    // Drag Drop\n    this.removeDragDropListener = dragDrop(this.el, (files) => {\n      this.handleDrop(files)\n    })\n  }\n\n  removeEvents () {\n    const showModalTrigger = findDOMElement(this.opts.trigger)\n    if (!this.opts.inline && showModalTrigger) {\n      showModalTrigger.removeEventListener('click', this.showModal)\n    }\n\n    this.removeDragDropListener()\n    document.body.removeEventListener('keyup', this.handleEscapeKeyPress)\n  }\n\n  actions () {\n    this.core.on('core:file-added', this.hideAllPanels)\n    this.core.on('dashboard:file-card', this.handleFileCard)\n\n    window.addEventListener('resize', this.updateDashboardElWidth)\n  }\n\n  removeActions () {\n    window.removeEventListener('resize', this.updateDashboardElWidth)\n\n    this.core.off('core:file-added', this.hideAllPanels)\n    this.core.off('dashboard:file-card', this.handleFileCard)\n  }\n\n  updateDashboardElWidth () {\n    const dashboardEl = this.target.querySelector('.UppyDashboard-inner')\n    this.core.log(`Dashboard width: ${dashboardEl.offsetWidth}`)\n\n    const modal = this.core.getState().modal\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        containerWidth: dashboardEl.offsetWidth\n      })\n    })\n  }\n\n  handleFileCard (fileId) {\n    const modal = this.core.getState().modal\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        fileCardFor: fileId || false\n      })\n    })\n  }\n\n  handleDrop (files) {\n    this.core.log('All right, someone dropped something...')\n\n    files.forEach((file) => {\n      this.core.addFile({\n        source: this.id,\n        name: file.name,\n        type: file.type,\n        data: file\n      })\n    })\n  }\n\n  cancelAll () {\n    this.core.emit('core:cancel-all')\n  }\n\n  pauseAll () {\n    this.core.emit('core:pause-all')\n  }\n\n  resumeAll () {\n    this.core.emit('core:resume-all')\n  }\n\n  render (state) {\n    const files = state.files\n\n    const newFiles = Object.keys(files).filter((file) => {\n      return !files[file].progress.uploadStarted\n    })\n    const inProgressFiles = Object.keys(files).filter((file) => {\n      return !files[file].progress.uploadComplete &&\n             files[file].progress.uploadStarted &&\n             !files[file].isPaused\n    })\n\n    let inProgressFilesArray = []\n    inProgressFiles.forEach((file) => {\n      inProgressFilesArray.push(files[file])\n    })\n\n    // total size and uploaded size\n    let totalSize = 0\n    let totalUploadedSize = 0\n    inProgressFilesArray.forEach((file) => {\n      totalSize = totalSize + (file.progress.bytesTotal || 0)\n      totalUploadedSize = totalUploadedSize + (file.progress.bytesUploaded || 0)\n    })\n    totalSize = prettyBytes(totalSize)\n    totalUploadedSize = prettyBytes(totalUploadedSize)\n\n    const acquirers = state.modal.targets.filter((target) => {\n      return target.type === 'acquirer'\n    })\n\n    const progressindicators = state.modal.targets.filter((target) => {\n      return target.type === 'progressindicator'\n    })\n\n    // const addFile = (file) => {\n    //   this.core.emitter.emit('core:file-add', file)\n    // }\n\n    const removeFile = (fileID) => {\n      this.core.emitter.emit('core:file-remove', fileID)\n    }\n\n    const startUpload = (ev) => {\n      this.core.upload().catch((err) => {\n        // Log error.\n        console.error(err.stack || err.message || err)\n      })\n    }\n\n    const pauseUpload = (fileID) => {\n      this.core.emitter.emit('core:upload-pause', fileID)\n    }\n\n    const cancelUpload = (fileID) => {\n      this.core.emitter.emit('core:upload-cancel', fileID)\n      this.core.emitter.emit('core:file-remove', fileID)\n    }\n\n    const showFileCard = (fileID) => {\n      this.core.emitter.emit('dashboard:file-card', fileID)\n    }\n\n    const fileCardDone = (meta, fileID) => {\n      this.core.emitter.emit('core:update-meta', meta, fileID)\n      this.core.emitter.emit('dashboard:file-card')\n    }\n\n    const info = (text, type, duration) => {\n      this.core.info(text, type, duration)\n    }\n\n    const resumableUploads = this.core.getState().capabilities.resumableUploads || false\n\n    return Dashboard({\n      state: state,\n      modal: state.modal,\n      newFiles: newFiles,\n      files: files,\n      totalFileCount: Object.keys(files).length,\n      totalProgress: state.totalProgress,\n      acquirers: acquirers,\n      activePanel: state.modal.activePanel,\n      progressindicators: progressindicators,\n      autoProceed: this.core.opts.autoProceed,\n      hideUploadButton: this.opts.hideUploadButton,\n      id: this.id,\n      hideModal: this.hideModal,\n      showProgressDetails: this.opts.showProgressDetails,\n      inline: this.opts.inline,\n      semiTransparent: this.opts.semiTransparent,\n      showPanel: this.showPanel,\n      hideAllPanels: this.hideAllPanels,\n      log: this.core.log,\n      i18n: this.containerWidth,\n      pauseAll: this.pauseAll,\n      resumeAll: this.resumeAll,\n      addFile: this.core.addFile,\n      removeFile: removeFile,\n      info: info,\n      note: this.opts.note,\n      metaFields: state.metaFields,\n      resumableUploads: resumableUploads,\n      startUpload: startUpload,\n      pauseUpload: pauseUpload,\n      cancelUpload: cancelUpload,\n      fileCardFor: state.modal.fileCardFor,\n      showFileCard: showFileCard,\n      fileCardDone: fileCardDone,\n      updateDashboardElWidth: this.updateDashboardElWidth,\n      maxWidth: this.opts.maxWidth,\n      maxHeight: this.opts.maxHeight,\n      currentWidth: state.modal.containerWidth,\n      isWide: state.modal.containerWidth > 400\n    })\n  }\n\n  install () {\n    // Set default state for Modal\n    this.core.setState({modal: {\n      isHidden: true,\n      showFileCard: false,\n      activePanel: false,\n      targets: []\n    }})\n\n    const target = this.opts.target\n    const plugin = this\n    this.target = this.mount(target, plugin)\n\n    if (!this.opts.disableStatusBar) {\n      this.core.use(StatusBar, {\n        target: DashboardUI\n      })\n    }\n\n    if (!this.opts.disableInformer) {\n      this.core.use(Informer, {\n        target: DashboardUI\n      })\n    }\n\n    this.initEvents()\n    this.actions()\n  }\n\n  uninstall () {\n    this.unmount()\n    this.removeActions()\n    this.removeEvents()\n  }\n}\n"]}